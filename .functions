# vim: ft=sh

# Shorthand for determining whether a command exists on the system
function exists {
  command -v "$1" > /dev/null
}

# Print the extension of a file given its full path
function extension {
  echo "${$(basename $1)##*.}"
}

# Print the name of a file (without extension) given its full path
function filename {
  echo "${$(basename $1)%.*}"
}

function trim_newline {
  perl -pi -e 'chomp if eof' $1
}

# Change to a temp directory
function tmp {
  local dir=$TMPDIR
  : ${dir:="/tmp"}
  cd $dir
}

# Print local network and external IP addresses
function ip {
  echo "Local:    $(ipconfig getifaddr en0)"
  echo "External: $(curl -s http://checkip.dyndns.com/ | sed 's/[^0-9\.]//g')"
}

# Print the number of files/dirs in the given directory
function lc {
  local dir=$1
  : ${dir:="."}
  local list="ls -l \"$dir\" | grep -v '^total'"
  local count="wc -l | awk '{ print \$1 }'"

  echo "Files: $(eval "$list | grep -v '^d' | $count")"
  echo "Dirs:  $(eval "$list | grep '^d' | $count")"
  echo "Total: $(eval "$list | $count")"
}

# Resolve redirects and print the last non-30x URL
function end_url {
  curl $1 --silent --location --head --output /dev/null --write-out 'Final URL: %{url_effective}'
}
